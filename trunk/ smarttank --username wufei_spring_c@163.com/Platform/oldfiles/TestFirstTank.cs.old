using System;
using System.Collections.Generic;
using System.Text;
using Microsoft.Xna.Framework;
using Microsoft.Xna.Framework.Input;
using Platform.GameObjects.Tank;
using Platform.Logic.GameBackground;
using Platform.Logic.Phisics;
using Platform.GameObjects.Tank.Tanks;

namespace Platform.GameObjects.test
{
    class TestFirstTank : GameManager
    {
        FirstTank firstTank, secondTank;
        GameDataBase database;
        TankManualController controller;
        protected override void Initialize ()
        {
            base.Initialize();

            firstTank = new FirstTank( new Vector2( 150, 250 ), 0 );
            firstTank.Initialize();
            secondTank = new FirstTank( new Vector2( 33, 55 ), 0 );
            secondTank.Initialize();

            database = new GameDataBase();

            firstTank.Limits = new TankLimits();
            firstTank.Limits.MaxAngulaVelocity = (float)Math.PI / 100;
            firstTank.Limits.MaxForce = 0.5f * 9.8f * firstTank.NewtonPhisicalStatus.Weight;
            firstTank.Limits.MaxPower = 95 * firstTank.Limits.MaxForce;
            firstTank.Limits.MaxVelocity = 20;
            firstTank.Limits.MaxMoment = 0.5f * firstTank.NewtonPhisicalStatus.Inertia;

            secondTank.Limits = firstTank.Limits;

            controller = new TankManualController( firstTank.Controller );

            database.addElement( firstTank );
            database.addElement( secondTank );

        }

        protected override void GameDraw ( GameTime gameTime )
        {
            //firstTank.Draw();
            //secondTank.Draw();
            database.Draw();
        }

        protected override void Update ( GameTime gameTime )
        {
            base.Update( gameTime );

            KeyboardState KS = Keyboard.GetState();
            controller.HandleKeyStatus( KS );


            //if (KS.IsKeyDown(Keys.W)) {
            //    firstTank.Controller.MoveForward();
            //    // firstTank.pos += 3 * firstTank.Direction;
            //}

            //if (KS.IsKeyDown( Keys.S ))
            //{
            //    firstTank.Controller.MoveBackward();
            //   // firstTank.pos -= 2 * firstTank.Direction;
            //}
            //if (KS.IsKeyDown( Keys.D ))
            //{
            //    firstTank.Controller.RightTurn();
            //  //  firstTank.baseRota += 0.06f;
            //}
            //if (KS.IsKeyDown(Keys.A)) {
            //    firstTank.Controller.LeftTurn();
            //    //firstTank.baseRota -= 0.06f;
            //}
            //else {
            //    firstTank.Controller.StopTurning();
            //}
            //if (KS.IsKeyDown( Keys.J ))
            //{
            //   // firstTank.turretRota -= 0.06f;
            //}
            //if (KS.IsKeyDown( Keys.K ))
            //{
            //   // firstTank.turretRota += 0.06f;
            //}
            database.Update( (float)gameTime.ElapsedGameTime.TotalSeconds );
        }
    }
}
